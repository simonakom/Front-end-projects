<!-- https://www.thecocktaildb.com/api.php -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coctails</title>
    <link rel="icon" href="cocktail.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&family=Cormorant+SC:wght@400;600&display=swap" rel="stylesheet">
<style>
    body {
        font-family: 'Cormorant SC', serif;
        /* font-family: 'Cormorant Garamond', serif; */
        margin: 0;
        background-color: #1e1e2c;
    }
    .title{
        color: antiquewhite;
        background-color: #15151f;
        font-size: 40px;
        text-align: center;
        font-family: 'Cormorant SC', serif;
        margin: 0;
    }
    .coctail-container {
        font-family: 'Cormorant Garamond', serif;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        background-color: #15151f;
        }
    .coctail {
        width: 6%;
    }
    hr.gradient {
    border: none;
    height: 2px;
    background: linear-gradient(to right, #5da5c9, #d494de, #7b97bb, #4169e1, #8a2be2);
    }


    nav {
        background-color: #15151f;
    }
    .container {
        max-width: 1200px;
        margin:0 auto;
    }
    #coctail-name-filter, #category-select, #glass-type-select, #ingredient-select {
        background-color: #c0b1c381;
        border: none;
        padding: 0.5rem;
        border-radius: 6px;
        color: antiquewhite;
        width: 100%;
        box-shadow: 0px 0px 5px rgba(164, 200, 232, 0.539);
    }
    .buton {
        padding: 10px 30px;
        border: none;
        outline: none;
        border-radius: 15px;
        color: antiquewhite;
        background-color: #c0b1c381;
    }
    .buton:hover {
        transform: scale(1.1);
        transition: transform 0.3s ease-in-out;
        background-color: rgba(247, 228, 204, 0.892);
        color:  rgb(0, 0, 0);
        opacity: 0.8;
        box-shadow: 1px 1px 10px rgba(164, 200, 232, 0.539);
    } 


    .drinks {
        display: grid;
        grid-template-columns:1fr 1fr 1fr;
        gap: 3rem;
    }
    .drink {
        /* width: 80%; */
        /* margin: 0 auto; */
        box-shadow: 1px 2px 13px rgba(164, 200, 232, 0.539);
        background-color: #c0b1c322;
        border-top-left-radius: 15%;
        border-top-right-radius: 15%;
        border-bottom-left-radius: 15%;
        border-bottom-right-radius: 15%;
    }
    .drink:hover {
        transform: scale(1.02);
        transition: transform 0.2s ease-in-out;
        background-color: rgba(247, 228, 204, 0.892);
        opacity: 0.8;
        box-shadow: 1px 1px 40px rgba(164, 200, 232, 0.539);
    } 

    .drink .drink-title{
        margin: 0 auto;
        text-align: center;
        color: antiquewhite;
        display: flex;
        flex-direction: column;
        justify-content: center; 
        height: 30%;
        padding: 0px 30px 32px 30px;
    }
    .drink:hover .drink-title {
        color:  rgb(0, 0, 0);
    }
    .drink img{
        width: 100%;
        border-top-left-radius: 15%;
        border-top-right-radius: 15%;
        border-bottom-right-radius: 40%;
    }
    .star1 {
        width: 4%;
        display: block;
        position: absolute;
        bottom: 720px;
        left: 650px;
    }
</style>
</head>
<body>
    <div class="coctail-container decoration row py-3">
        <img src="cocktail.png" class="coctail">
        <img src="sparkling.png" class="star1">       
        <p class="title mb-3">Coctail Finder</p>
        <hr class="gradient">
    </div>
    <nav>
        <div class="container pb-4">
            <div class="d-flex gap-4">
                <input type="text" class="form-control" id="coctail-name-filter" placeholder="Search by Coctail Name" aria-label="Username" aria-describedby="basic-addon1">
                <select class="form-select" id="category-select"></select>
                <select class="form-select" id="glass-type-select"></select>
                <select class="form-select" id="ingredient-select"></select>
                <button id="Search" class="buton" type="button" class="btn btn-light">Search</button>
                <button id="challenge" class="buton" type="button" class="btn btn-light">Challenge!</button>
            </div>
        </div>
        <hr class="gradient">
    </nav>

<div class="container my-5">
    <div class="drinks">
         <!-- <div class="drink"><img src="https://www.thecocktaildb.com/images/media/drink/km84qi1513705868.jpg" alt="Coctail photo">
            <h2 class="drink-title py-3 px-4">Boulevardier</h2>
        </div>
        <d iv class="drink"><img src="https://www.thecocktaildb.com/images/media/drink/rptuxy1472669372.jpg" alt="Coctail photo">
            <h2 class="drink-title py-3 px-4">A True Amaretto Sour</h2>
        </d>
        <div class="drink"><img src="https://www.thecocktaildb.com/images/media/drink/ck6d0p1504388696.jpg" alt="Coctail photo">
            <h2 class="drink-title py-3">Cuba Libra</h2>
        </div> -->
    </div>
</div>

<script>
//TO-DO:
//1. Selectu uzpildymas duomenimis ✓
//2. Gauname visus gerimus is API  ✓
//3. Juos atvaizduojame  ✓
//4. Atlikti filtracijas kokteiliams
//5. Paieska pagal pavadinima
//6. Modalinio lango sukurimas
//7. Modalinio lango uzdarymas
//8. Atsitiktinio kokteilio gavimas su mygtuku "Challenge"

    const categoriesArray = [];
    console.log(categoriesArray);
    const drinksArray = [];
    console.log(drinksArray);

    const coctailNameFilterElement = document.querySelector("#coctail-name-filter"),
    categorySelectElement = document.querySelector("#category-select"),
    glassSelectElement = document.querySelector("#glass-type-select"),
    ingredientSelectElement = document.querySelector("#ingredient-select"),
    dynamicDrinksElement = document.querySelector(".drinks");


    //Prisideda await tma kad funkcija vykdytu visus fetch is eiles
    async function fillSelectElements (){ 
    await fetch("https://www.thecocktaildb.com/api/json/v1/1/list.php?c=list") //kategoriju sarasas
    .then((response) => response.json()) //json- tam kad nebutu headeriu   
    .then((response) => {  
        fillSelect(response.drinks, categorySelectElement, "strCategory")
        categoriesArray.push(...response.drinks.map((value)=>value.strCategory)); //map: kad kiekviena reksme pasikeistu i stringa
    })
    .catch((error)=> console.log(error));
    // .finally(() => console.log ("uzklausa baigta"));

    await fetch("https://www.thecocktaildb.com/api/json/v1/1/list.php?g=list")//glass sarasas
    .then((response) => response.json()) 
    .then((response) => fillSelect(response.drinks, glassSelectElement, "strGlass"))
    .catch((error)=> console.log(error))

    await fetch("https://www.thecocktaildb.com/api/json/v1/1/list.php?i=list")//ingredient sarasas
    .then((response) => response.json()) 
    .then((response) => fillSelect(response.drinks, ingredientSelectElement, "strIngredient1"))
    .catch((error)=> console.log(error))
    }
 
    //Uzpildo visus select pagal parametrus
    function fillSelect(properties, selectElement, strFieldName ){
        let dynamicHTML = '';
        for(const property of properties){
            // console.log(category.strCategory); 
            dynamicHTML += `<option>${property[strFieldName]}</option>`;
            // categoriesArray.push(property.strFieldName);
        }
        // console.log(categoriesArray);
        selectElement.innerHTML = dynamicHTML;
    }

    // funkcija kuris iskvies visus gerimus is API, kai gerimai bus gauti viename masyve  - bus daromas atvaizdavimas
    async function getAllDrinks(){
        // https://www.thecocktaildb.com/api/json/v1/1/filter.php?c=Ordinary_Drink
        for (const category of categoriesArray){
             let dynamicURL = `https://www.thecocktaildb.com/api/json/v1/1/filter.php?c=${category.replaceAll(" ", "_")}`;
             const response = await fetch(dynamicURL); //nereikia naudoti then metoda ir tiesiog galima pasiimti atsakyma
             const answerFromServer = await response.json();
                for(const drink of answerFromServer.drinks){
                    drinksArray.push(drink)
                }
             console.log(dynamicURL);
             console.log(answerFromServer);
        }
    }

    //dinamiskas atvaizdavimas
    function generateDrinksHTML(drinks){
        let dynamicHTML = "";
        for(let drink of drinks){
            dynamicHTML += `<div class="drink"><img src="${drink.strDrinkThumb}" alt="Coctail photo">
            <h2 class="drink-title mb-4">${drink.strDrink}</h2></div>`;
        }
        dynamicDrinksElement.innerHTML=dynamicHTML; 
    }


    //Funkcija kuri atvaiduoja visu selectu elementus
    async function initialization (){
        //1. 1 initializazion fase - uzpildomi selectai
        await fillSelectElements();
        await getAllDrinks();
        generateDrinksHTML(drinksArray); 
        //2. 2 initializazion fase - dinaminis gerimu atvaizdavimas. Is pirmo reikia gauti visas kategorijas i viena array (categoriesArray).
    }
    initialization();




</script>
</body>
</html> 


